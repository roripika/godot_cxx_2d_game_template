start_scene: "warehouse_investigation"

scenes:
  warehouse_investigation:
    scene_path: "res://samples/mystery/warehouse_investigation.tscn"
    on_enter:
      - dialogue: 
          speaker: "System"
          text: "調査を開始します..."
      - dialogue:
          speaker: "Detective"
          text: "ここは倉庫だ。なんだか…寒いな。"
    
    hotspots:
      ectoplasm_spot:
        node_id: "EctoplasmSpot"
        on_click:
          - if_has_items:
              items: ["ectoplasm"]
              then:
                - dialogue: { speaker: "Detective", text: "エクトプラズムはもう回収した。" }
              else:
                - dialogue: { speaker: "Detective", text: "この光る粘液はなんだ？" }
                - dialogue: { speaker: "System", text: "エクトプラズムを見つけた！" }
                - give_evidence: "ectoplasm"
                - set_flag: { key: "found_ecto", value: true }

      footprint_spot:
        node_id: "FootprintSpot"
        on_click:
          - dialogue:
              speaker: "Detective"
              text: "巨大な足跡だ。"
          - if_flag:
              key: "found_footprint"
              value: true
              then:
                - dialogue:
                    speaker: "Detective"
                    text: "おい！これ誰がやったか見たか？"
                - testimony:
                    max_rounds: 3
                    testimonies:
                      - 
                        speaker: "Rat Witness"
                        text: "何も見てないッス！隠れてたッスから！"
                        shake: "隠れてた？なんで？"
                      - 
                        speaker: "Rat Witness"
                        text: "一晩中静かだったッスよ、マジで！"
                        evidence: "footprint"
                        shake: "静かだった？こんなデカい化け物がいてか？"
                    on_success:
                      - dialogue:
                          speaker: "Rat Witness"
                          text: "わかったッス！デカい獣が通ったッス！"
                      - set_flag:
                          key: "beast_revealed"
                          value: true
                    on_failure:
                      - dialogue:
                          speaker: "Rat Witness"
                          text: "ほら、何もなかったって言ったじゃないッスか。"
                      - take_damage: 20
              else:
                - dialogue:
                    speaker: "System"
                    text: "血のついた足跡を見つけた！"
                - give_evidence: "footprint"
                - set_flag:
                    key: "found_footprint"
                    value: true

      memo_spot:
        node_id: "MemoSpot"
        on_click:
          - dialogue: { speaker: "Detective", text: "木箱の下に紙切れがある。" }
          - choice:
              choices:
                - option:
                    text: "拾う"
                    actions:
                      - give_evidence: "torn_memo"
                      - dialogue: { speaker: "System", text: "破れたメモを入手した。" }
                - option:
                    text: "放っておく"
                    actions:
                      - dialogue: { speaker: "Detective", text: "まだ触らないほうがいいか。" }
